{% extends 'base/admin.html' %}
{% load static %}

{% block content %}
    <!--内容栏-->
    <table class="table">
        <tr>
            <td class="yellow" style="width: 20%">用户昵称</td>
            <td class="yellow" style="width: 20%">用户账号</td>
            <td class="yellow" style="width: 20%">用户状态</td>
            <td class="yellow" style="width: 20%">等级权限</td>
            <td class="yellow" style="width: 20%">创建时间</td>
            <td style="width: 20%">
                <form method="get" action="{% url 'user:insert' %}">
                    <input type="submit" class="btn btn-primary" value="添加">
                </form>
            </td>
        </tr>
        {% for user in user_list %}
            <tr>
                <td class="yellow">{{ user.username }}</td>
                <td class="yellow">{{ user.email }}</td>
                <td class="yellow">{{ user.state }}</td>
                <td class="yellow">{{ user.level }}</td>
                <td class="yellow">{{ user.create_time }}</td>
                <td>
                    <form method="get" action="{% url 'user:content' %}">
                        <input type="hidden" name="user_id" value="{{ user.user_id }}">
                        <input type="submit" class="btn btn-primary" value="查看">
                    </form>
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}

{% block js %}
    <script>
        user_freeze = "{% url 'user:api_freeze' %}";
        user_unfreeze = "{% url 'user:api_unfreeze' %}"
    </script>
    <script>
        $(document).ready(function () {
            $("#btn_freeze").click(function () {
                $.ajax({
                    url: user_freeze,
                    type: "POST",
                    data: $("#user_freeze").serialize(),
                    success: function (res) {
                        $("#user_unfreeze").show();
                        $("#user_freeze").hide();
                        alert(res)
                    }
                })
            })
            $("#btn_unfreeze").click(function () {
                $.ajax({
                    url: user_unfreeze,
                    type: "POST",
                    data: $("#user_unfreeze").serialize(),
                    success: function (res) {
                        $("#user_freeze").show();
                        $("#user_unfreeze").hide();
                        alert(res)
                    }
                })
            })
        })
    </script>
{% endblock %}

