{% extends 'base/admin.html' %}
{% load static %}

{% block content %}
    <!--内容栏-->
    <div class="container">
        <div class="col-md-6 offset-md-3">
            <table class="table">
                <form id="user_insert">
                    {% csrf_token %}
                    <tr class="yellow">
                        <td style="width: 20%">
                            <p>账号: </p>
                        </td>
                        <td>
                            <input class="col-md-12" type="text" name="username">
                            <p id="username"></p>
                        </td>
                    </tr>
                    <tr class="yellow">
                        <td style="width: 20%">
                            <p>密码: </p>
                        </td>
                        <td>
                            <input class="col-md-12" type="text" name="password">
                            <p id="password"></p>
                        </td>
                    </tr>
                    <tr class="yellow">
                        <td style="width: 20%">
                            <p>电话: </p>
                        </td>
                        <td>
                            <input class="col-md-12" type="text" name="phone">
                            <p id="phone"></p>
                        </td>
                    </tr>
                    <tr class="yellow">
                        <td style="width: 20%">
                            <p>邮件: </p>
                        </td>
                        <td>
                            <input class="col-md-12" type="text" name="email">
                            <p id="email"></p>
                        </td>
                    </tr>
                    <tr class="yellow">
                        <td style="width: 20%">
                            <p>状态: </p>
                        </td>
                        <td>
                            <input type="hidden" name="state" id="state" value="0">
                            <select class="col-md-12" id="state_select">
                                <option value="0">使用</option>
                                <option value="1">冻结</option>
                            </select>
                        </td>
                    </tr>
                    <tr class="yellow">
                        <td style="width: 20%">
                            <p>等级: </p>
                        </td>
                        <td>
                            <input type="hidden" name="level" id="level" value="0">
                            <select class="col-md-12" id="level_select">
                                <option value="1">用户</option>
                                <option value="0">管理员</option>
                            </select>
                        </td>
                    </tr>
                    <tr class="yellow">
                        <td>
                            <input class="btn btn-warning" id="btn-back" type="button" value="返回">
                        </td>
                        <td>
                            <input class="btn btn-primary col-md-12" id="btn-insert" type="button" value="添加">
                        </td>
                    </tr>
                </form>
            </table>
            <p class="yellow" id="message"></p>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script>
        user_insert = "{% url 'user:api_insert' %}";
        user_list = "{% url 'user:user_list' %}";
    </script>
    <script>
        $(document).ready(function () {
            $("#btn-insert").click(function () {
                $.ajax({
                    url: user_insert,
                    type: "POST",
                    data: $("#user_insert").serialize(),
                    success:function (res) {
                        if (res.code === 0){
                            alert(res.msg)
                        } else if (res.code === 1) {
                            alert("请求错误")
                        } else if (res.code === 2){
                            for (i in res.msg){
                                $("#" + i).append(res.msg[i])
                            }
                        } else if (res.code === 3) {
                            alert(res.msg)
                        }
                    }
                })
            })
            $("#btn-back").click(function () {
                $(location).attr("href", user_list)
            })
            $("#level_select").change(function () {
                $("#level").val($("#level_select").val())
            })
            $("#state_select").change(function () {
                $("#state").val($("#state_select").val())
            })
        })
    </script>
    <script>
        $(document).ready(function () {

        })
    </script>
{% endblock %}
